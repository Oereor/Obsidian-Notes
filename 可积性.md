### 可积的必要条件: 有界性

若 $f\in R[a,b]$, 则 $f$ 在 $[a,b]$ 上有界. *注意: 反之不成立. 反例: Dirichlet函数.* 

### 可积的充要条件
记 $\displaystyle M_k=\sup_{x\in[x_{k-1},x_k]}f(x)$, $\displaystyle m_k=\inf_{x\in[x_{k-1},x_k]}f(x)$. 则有 $$m_k\Delta x_k\le f(\xi_k)\Delta x_k\le M_k\Delta x_k.$$ 那么 $$\sum_{k=1}^n m_k\Delta x_k\le \sum_{k=1}^n f(\xi_k)\Delta x_k\le \sum_{k=1}^n M_k\Delta x_k.$$ 此处有定义: 

> **(Darboux) 上和与下和.** 设 $f$ 在 $[a,b]$ 上有界, 对任意分割 $\pi=\{x_0,x_1,\ldots,x_n\}$, 定义 $f$ 在 $\pi$ 下的下和与上和分别为 $$\underline{S}(f,\pi)=\sum_{k=1}^n m_k\Delta x_k,$$ $$\overline{S}(f,\pi)=\sum_{k=1}^n M_k\Delta x_k.$$ 显然有 $\underline{S}(f,\pi)\le S(f,\pi,\xi)\le \overline{S}(f,\pi)$.

同时有以下引理. 

> 若 $\pi'$ 是 $\pi$ 的一个加细分割 (即加入新的分点), 则 $$\underline{S}(f,\pi)\le \underline{S}(f,\pi'),\qquad\overline{S}(f,\pi')\le \overline{S}(f,\pi).$$ 即 **"上和不增, 下和不减".** 

利用此引理, 可以证明**任意下和都不大于任意上和**. 这就是说, 对任意分割 $\pi_1,\pi_2$, 有 $$\underline{S}(f,\pi_1)\le \overline{S}(f,\pi_2).$$ 
> **证明.** $\pi_3=\pi_1\cup \pi_2$ 是 $\pi_1,\pi_2$ 的一个加细分割, 故 $$\underline{S}(f,\pi_1)\le \underline{S}(f,\pi_3)\le \overline{S}(f,\pi_3)\le \overline{S}(f,\pi_2).$$ 证毕. 

于是可以定义上积分与下积分.

> **上积分与下积分.** 设 $f$ 在 $[a,b]$ 上有界, 定义 $$\overline{\int_a^b}f(x)\,dx=\inf_{\pi}\overline{S}(f,\pi),\qquad\underline{\int_a^b}f(x)\,dx=\sup_{\pi}\underline{S}(f,\pi).$$ 分别称为 $f$ 在 $[a,b]$ 上的上积分与下积分. 显然有 $\displaystyle\underline{\int_a^b}f(x)\,dx\le \overline{\int_a^b}f(x)\,dx.$ 

据此, 得到 Riemann 可积的一个等价条件. 

> **定理.** 设 $f$ 在 $[a,b]$ 上有界, 则 $f\in R[a,b]$ 的充要条件是 $$\underline{\int_a^b}f(x)\,dx=\overline{\int_a^b}f(x)\,dx.$$ 此时称其公值为 $\displaystyle\int_a^b f(x)\,dx.$ 
>
> **证明.** *(必要性)* 设 $f\in R[a,b]$, 则对任意 $\varepsilon>0$, 存在分割 $\pi$ 使得对任意 $\xi$ 有 $$\left|S(f,\pi,\xi)-\int_a^b f(x)\,dx\right|<\varepsilon.$$ 因为 $\underline{S}(f,\pi)\le S(f,\pi,\xi)\le \overline{S}(f,\pi)$, 故 $$\underline{S}(f,\pi)-\varepsilon<\int_a^b f(x)\,dx<\overline{S}(f,\pi)+\varepsilon.$$ 由上积分与下积分的定义可知 $$\underline{\int_a^b}f(x)\,dx\ge \underline{S}(f,\pi)>\int_a^b f(x)\,dx-\varepsilon,\qquad\overline{\int_a^b}f(x)\,dx\le \overline{S}(f,\pi)<\int_a^b f(x)\,dx+\varepsilon.$$ 由于 $\varepsilon$ 任意, 故 $\displaystyle\underline{\int_a^b}f(x)\,dx=\overline{\int_a^b}f(x)\,dx=\int_a^b f(x)\,dx.$ 
> 
> *(充分性)* 设 $\displaystyle\underline{\int_a^b}f(x)\,dx=\overline{\int_a^b}f(x)\,dx=I$. 对任意 $\varepsilon>0$, 存在分割 $\pi_1,\pi_2$ 使得 $$\overline{S}(f,\pi_1)<I+\varepsilon,\qquad \underline{S}(f,\pi_2)>I-\varepsilon.$$ 设 $\pi=\pi_1\cup \pi_2$, 则 $$\overline{S}(f,\pi)\le \overline{S}(f,\pi_1)<I+\varepsilon,\qquad\underline{S}(f,\pi)\ge \underline{S}(f,\pi_2)>I-\varepsilon.$$ 因此对任意 $\xi$ 有 $$I-\varepsilon<\underline{S}(f,\pi)\le S(f,\pi,\xi)\le \overline{S}(f,\pi)<I+\varepsilon,$$ 即 $$\left|S(f,\pi,\xi)-I\right|<\varepsilon.$$ 由 Riemann 可积的定义可知 $f\in R[a,b]$ 且 $\displaystyle\int_a^b f(x)\,dx=I.$ 证毕.