### 引理: 真分式的唯一分解形式

简单说, *真分式一定能分解成以下两种形式之一的若干部分分式之和.*

1. $\displaystyle\frac{A}{(x-a)^k}$

2. $\displaystyle\frac{Bx+C}{(x+px+q)^k}$

### 对应的积分公式

1. $$\int\frac{1}{(x-a)^n}\,dx=\begin{dcases}
    \ln|x-a|+C,&n=1\\
    -\frac{1}{(n-1)(x-a)^{n-1}}+C,&n\geq 2
\end{dcases}$$

2. 先配方. $$\int\frac{Bx+C}{(x+px+q)^n}\,dx=\int\frac{Bx+C}{\left( \left( x+\frac{p}{2} \right)^2+q-\frac{p^2}{4} \right)^n}\,dx$$ 
变量代换, $\displaystyle u=x+\frac{p}{2}$, $a=\displaystyle\sqrt{q-\frac{p^2}{4}}$. 

于是可将积分化成如下形式: 
$$\int\frac{Bx+C}{(x^2+px+q)^n}\,dx=BI_n+\left( C-\frac{Bp}{2} \right)J_n$$
其中, 
$$I_n=\int\frac{u}{(u^2+a^2)^n}\,du=\frac{1}{2}\int\frac{1}{(u^2+a^2)^n}\,d(u^2+a^2)$$
$$J_n=\frac{1}{(u^2+a^2)^n}\,du$$
$I_n$可直接积出, 而 $J_n$ 可以递推 (参见[[分部积分的应用]], 第2条). 

### 例题

求解积分 $\displaystyle\int\frac{x^4-x^3-x^2-3x}{(x^2-1)(x^2+1)}\,dx$. 