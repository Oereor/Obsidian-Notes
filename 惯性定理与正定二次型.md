由于标准二次型的矩阵是对角矩阵, 因此虽然二次型的标准型不唯一, 但它含有的非零项数量是一定的, 即等于二次型的秩. 

### 惯性定理

> **定理.** 任何实二次型经过非退化的线性变换后所得的标准型中正系数项的个数都相同. 也就是说, 若 $f(x_1,\dots,x_n)$ 可化为 $$f=d_1y_1^2+\cdots+d_{p}y_p^2-d_{p+1}y_{p+1}^2-\cdots -d_{r}y_{r}^2,$$ 其中 $d_i>0$, $r$ 为二次型的秩, 则不论如何选取非退化线性变换, 所得标准型中正系数项的个数均为 $p$. 

这个整数 $p$ 称为二次型的**正惯性指数**. 类似地, 负系数项的个数 $q=r-p$ 称为二次型的**负惯性指数**; $s=p-q=2p-r$ 称为**符号差**. 由此可根据 $p,q,r,s$ 中的任意两项确定二次型的规范标准型; 换句话说, 二次型的规范标准型唯一.

> **证明.** 假定 $r(f)=r$, 并假定 $f$ 由两个非奇异线性替换 $x=P_1 y$ 和 $x=P_2 z$ 分别化为标准型 $$f=d_1y_1^2+\cdots+d_{p}y_p^2-d_{p+1}y_{p+1}^2-\cdots -d_{r}y_{r}^2,$$ $$f=l_1z_1^2+\cdots+l_qz_q^2-l_{q+1}z_{q+1}^2-\cdots -l_{r}z_{r}^2,$$ 其中 $d_i>0,l_i>0$. 现欲证明 $p=q$. 用反证法, 不妨设 $p<q$, 考虑 $y=P_1^{-1}x$ 和 $z=P_2^{-1}x$ 构成的齐次线性方程组 $$\begin{cases}
    y_1=d_{11}x_1+\cdots+d_{1n}x_n=0,\\
    y_2=d_{21}x_1+\cdots+d_{2n}x_n=0,\\
    \cdots\cdots\cdots\cdots\cdots\cdots \\
    y_p=d_{p1}x_1+\cdots+d_{pn}x_n=0,\\
    z_{q+1}=l_{q+1,1}x_1+\cdots+l_{q+1,n}x_n=0,\\
    \cdots\cdots\cdots\cdots\cdots\cdots \\
    z_n=l_{n1}x_1+\cdots+l_{nn}x_n=0.
\end{cases}$$ 这个方程组有 $n$ 个未知数, 但方程个数为 $p+(n-q)=n-(q-p)<n$, 因此它有非零解 $x_0$. 由此可得 $y_1(x_0)=y_2(x_0)=\cdots=y_p(x_0)=0$ 和 $z_{q+1}(x_0)=z_{q+2}(x_0)=\cdots=z_n(x_0)=0$. 于是 $$\begin{align*}
    f(x_0)&=d_1y_1^2(x_0)+\cdots+d_{p}y_p^2(x_0)-d_{p+1}y_{p+1}^2(x_0)-\cdots -d_{r}y_{r}^2(x_0)\\
    &= -d_{p+1}y_{p+1}^2(x_0)-\cdots -d_{r}y_{r}^2(x_0)\leq 0,
\end{align*}$$ 同时又有 $$\begin{align*}
    f(x_0)&=l_1z_1^2(x_0)+\cdots+l_qz_q^2(x_0)-l_{q+1}z_{q+1}^2(x_0)-\cdots -l_{r}z_{r}^2(x_0)\\
    &= l_1z_1^2(x_0)+\cdots+l_qz_q^2(x_0)\geq 0.
\end{align*}$$ 于是 $f(x_0)=0$, 进而 $y_{p+1}(x_0)=\cdots=y_r(x_0)=0$ 和 $z_1(x_0)=\cdots=z_q(x_0)=0$. 综上, $y_1(x_0)=y_2(x_0)=\cdots=y_n(x_0)=0$ 和 $z_1(x_0)=z_2(x_0)=\cdots=z_n(x_0)=0$. 由于 $P_1,P_2$ 均为非奇异矩阵, 故 $x_0=0$, 矛盾! 因此 $p=q$. 证毕.

这个定理有若干推论. 

**推论1.** 任何一个实对称矩阵 $A_n$ 都合同于对角矩阵 $$\begin{bmatrix}
    E_p & & \\
    & -E_q & \\
    & & O
\end{bmatrix}$$ 其中 $p$ 为正惯性指数, $q$ 为负惯性指数, 且 $p+q=r(A)$. 

**推论2.** 设 $f=x^TA_n x$, $g=y^TB_n y$, 如果 $r(A)=r(B)$ 且 $f,g$ 的正惯性指数相等, 则存在非奇异线性替换 $x=Py$ 使得 $B=P^TAP$. 

**推论3.** 两个 $n$ 阶实对称矩阵合同的充分必要条件是它们有相同的秩且正惯性指数相等.

********

**例.** 设 $A_n$ 是一个实对称矩阵, 且 $|A|<0$. 证明: 存在 $x_0\in\mathbb{R}^n$ 使得 $x_0^TAx_0<0$.

> **解.** 由于 $|A|<0$, 故 $r(A)=n$, 且 $A$ 至少有一个负的特征值. 于是设 $f=x^TAx$ 的正惯性指数为 $p$, 则 $p\leq n-1$. 由惯性定理, $f$ 可化为规范标准型 $$f=y_1^2+\cdots+y_p^2 - y_{p+1}^2 - \cdots - y_n^2.$$ 那么取 $y_0=(0,0,\dots,0,1)^T$, 则有 $f(y_0)=-1<0$. 由 $x=Py$ 可知存在 $x_0=Py_0$ 使得 $f(x_0)=x_0^TAx_0=f(y_0)=-1<0$. 证毕.

********
### 二次型的分类

如果二次型的秩为 $r$, 按合同关系可以将其分为若干等价类. 令正惯性指数 $p$ 取遍 $0,1,2,\dots,r$, 则每个 $p$ 值对应一个等价类, 因此秩为 $r$ 的二次型共有 $r+1$ 个等价类. 每个等价类的规范代表元为 $$f=y_1^2+\cdots+y_p^2 - y_{p+1}^2 - \cdots - y_r^2.$$

更进一步, 考察 $n$ 阶二次型. 将秩和正惯性指数相同的二次型分为一类, 由于 $0\leq p\leq r\leq n$, 故 $n$ 阶二次型共有 $$\sum_{r=0}^n (r+1)=\frac{(n+1)(n+2)}{2}$$ 个等价类. 每个等价类的规范代表元为 $$f=y_1^2+\cdots+y_p^2 - y_{p+1}^2 - \cdots - y_r^2.$$

于是得到下面的定理. 

> **定理.** $n$ 阶实二次型按合同关系分类共有 $\displaystyle\frac{1}{2}(n+1)(n+2)$ 类. 